# 🚢 Harbor 介绍文档

## 📌 一、Harbor 简介
Harbor 是一个用于存储和分发容器镜像的企业级 Registry 服务，由 VMware 开源。它在 Docker Registry 的基础上扩展了角色访问控制、镜像复制、审计日志、镜像扫描、安全策略等企业功能，支持 Helm Chart 的托管，适用于多租户场景。

## ⚙️ 二、Harbor 的原理
Harbor 是一个基于 RESTful API 的架构，依赖于底层的 Docker Registry，提供增强的访问控制、安全机制、镜像扫描与复制等能力。它将镜像存储、权限认证、用户管理、审计日志、Web UI 和第三方集成模块有效结合，构建了一个全面的镜像管理平台。

核心原理包括：
- 🧑‍💻 用户通过 Web UI 或 CLI 登录 Harbor，获取 token
- 🔐 使用 token 进行权限控制和身份认证
- 🔁 支持多种镜像复制策略，实现跨数据中心的镜像同步
- 🛡️ 对接 Trivy 等扫描器实现漏洞检测

## 🧱 三、Harbor 架构图
```
+---------------------+
|     Web UI          |
+----------+----------+
           |
+----------v----------+
|     API Server      |<------------+
+----------+----------+             |
           |                        |
+----------v----------+   +---------v----------+
|     Core Services   |   |  Authentication    |
| (Project/User Mgmt) |   | (LDAP/DB/OIDC)     |
+----------+----------+   +---------+----------+
           |                        |
+----------v----------+   +---------v----------+
|  Job Service        |   |   Scanner (Trivy)  |
+----------+----------+   +--------------------+
           |
+----------v----------+
|  Registry (Docker)  |
+----------+----------+
           |
+----------v----------+
|    Storage Backend  |
+---------------------+
```

## 🧰 四、Harbor 的作用
1. 🏢 **私有镜像仓库**：为企业提供安全的镜像仓库，防止公共仓库的不稳定和安全风险。
2. 🧑‍🔧 **访问控制和权限管理**：支持基于角色的访问控制 (RBAC)，确保资源隔离和权限安全。
3. 🌐 **镜像复制与多节点部署**：支持跨 Harbor 实例的镜像同步，便于多数据中心部署与备份。
4. 🕵️‍♂️ **镜像漏洞扫描**：集成 Trivy 等扫描工具，提升镜像安全性。
5. 📝 **审计日志**：记录所有用户操作，方便安全审计与问题追踪。
6. 📦 **支持 Helm Chart**：不仅支持容器镜像，还支持 Helm Chart 仓库管理。

## 🧾 五、总结
Harbor 作为企业级容器镜像管理平台，是构建安全、可靠、高效 DevOps 流水线的关键组件。通过其丰富的功能和良好的扩展性，为容器化生产环境提供了重要支持。
